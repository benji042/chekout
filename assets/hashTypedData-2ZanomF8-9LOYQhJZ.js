import{q as y,aw as b,a2 as I,b as T,a3 as g,aI as M,a4 as u,m as f,k as j,al as O,_ as W,f as k,aj as C,am as N,an as z}from"./index-C1smojh8.js";const _=`Ethereum Signed Message:
`;function q(t){const e=typeof t=="string"?g(t):typeof t.raw=="string"?t.raw:M(t.raw),s=g(`${_}${u(e)}`);return b([s,e])}function X(t,e){return y(q(t),e)}class A extends f{constructor({domain:e}){super(`Invalid domain "${j(e)}".`,{metaMessages:["Must be a valid EIP-712 domain."]})}}class J extends f{constructor({primaryType:e,types:s}){super(`Invalid primary type \`${e}\` must be one of \`${JSON.stringify(Object.keys(s))}\`.`,{docsPath:"/api/glossary/Errors#typeddatainvalidprimarytypeerror",metaMessages:["Check that the primary type is a key in `types`."]})}}class Y extends f{constructor({type:e}){super(`Struct type "${e}" is invalid.`,{metaMessages:["Struct type must not be a Solidity type."],name:"InvalidStructTypeError"})}}function B(t){const{domain:e,message:s,primaryType:a,types:n}=t,r=(i,o)=>{for(const S of i){const{name:x,type:m}=S,p=o[x],d=m.match(O);if(d&&(typeof p=="number"||typeof p=="bigint")){const[P,c,D]=d;W(p,{signed:c==="int",size:Number.parseInt(D,10)/8})}if(m==="address"&&typeof p=="string"&&!k(p))throw new C({address:p});const l=m.match(N);if(l){const[P,c]=l;if(c&&u(p)!==Number.parseInt(c,10))throw new z({expectedSize:Number.parseInt(c,10),givenSize:u(p)})}const h=n[m];h&&(G(m),r(h,p))}};if(n.EIP712Domain&&e){if(typeof e!="object")throw new A({domain:e});r(n.EIP712Domain,e)}if(a!=="EIP712Domain")if(n[a])r(n[a],s);else throw new J({primaryType:a,types:n})}function F({domain:t}){return[typeof(t==null?void 0:t.name)=="string"&&{name:"name",type:"string"},(t==null?void 0:t.version)&&{name:"version",type:"string"},(typeof(t==null?void 0:t.chainId)=="number"||typeof(t==null?void 0:t.chainId)=="bigint")&&{name:"chainId",type:"uint256"},(t==null?void 0:t.verifyingContract)&&{name:"verifyingContract",type:"address"},(t==null?void 0:t.salt)&&{name:"salt",type:"bytes32"}].filter(Boolean)}function G(t){if(t==="address"||t==="bool"||t==="string"||t.startsWith("bytes")||t.startsWith("uint")||t.startsWith("int"))throw new Y({type:t})}function H(t){const{domain:e={},message:s,primaryType:a}=t,n={EIP712Domain:F({domain:e}),...t.types};B({domain:e,message:s,primaryType:a,types:n});const r=["0x1901"];return e&&r.push(K({domain:e,types:n})),a!=="EIP712Domain"&&r.push(v({data:s,primaryType:a,types:n})),y(b(r))}function K({domain:t,types:e}){return v({data:t,primaryType:"EIP712Domain",types:e})}function v({data:t,primaryType:e,types:s}){const a=w({data:t,primaryType:e,types:s});return y(a)}function w({data:t,primaryType:e,types:s}){const a=[{type:"bytes32"}],n=[L({primaryType:e,types:s})];for(const r of s[e]){const[i,o]=$({types:s,name:r.name,type:r.type,value:t[r.name]});a.push(i),n.push(o)}return I(a,n)}function L({primaryType:t,types:e}){const s=T(R({primaryType:t,types:e}));return y(s)}function R({primaryType:t,types:e}){let s="";const a=E({primaryType:t,types:e});a.delete(t);const n=[t,...Array.from(a).sort()];for(const r of n)s+=`${r}(${e[r].map(({name:i,type:o})=>`${o} ${i}`).join(",")})`;return s}function E({primaryType:t,types:e},s=new Set){var n;const a=(n=t.match(/^\w*/u))==null?void 0:n[0];if(s.has(a)||e[a]===void 0)return s;s.add(a);for(const r of e[a])E({primaryType:r.type,types:e},s);return s}function $({types:t,name:e,type:s,value:a}){if(t[s]!==void 0)return[{type:"bytes32"},y(w({data:a,primaryType:s,types:t}))];if(s==="bytes")return a=`0x${(a.length%2?"0":"")+a.slice(2)}`,[{type:"bytes32"},y(a)];if(s==="string")return[{type:"bytes32"},y(T(a))];if(s.lastIndexOf("]")===s.length-1){const n=s.slice(0,s.lastIndexOf("[")),r=a.map(i=>$({name:e,type:n,types:t,value:i}));return[{type:"bytes32"},y(I(r.map(([i])=>i),r.map(([,i])=>i)))]}return[{type:s},a]}export{X,H as Y};
